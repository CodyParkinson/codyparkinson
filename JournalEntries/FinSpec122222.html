<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinSpec</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@100&display=swap" rel="stylesheet">
</head>
<body>
    <!--Navigation Bar-->
    <div class="nav_bar">
        <a href="../index.html">Cody Parkinson</a>
        <a href="../About.html">About</a>
        <a href="../PersonalProjects.html">Projects</a>
        <a href="../Journal.html">Journal</a>
    </div>
    <div style="clear:both;"></div>

    <H1 style="text-align: center; margin-top: 1rem;">FinSpec</H1>
    <h2 style="text-align: center; margin-bottom: 1rem;">12/22/2022</h2>

    <div class="JE_img_wrap">
    <img src="../images/FinSpecImages/MainFinSpecPage.png" alt="FinSpec Landing Page">
    <p style="text-align: center;"> Welcome to FinSpec </p>
    </div>

    <p id="JE_main_text">
        I would like to dedicate a page to the program I have built over the last year and a half. It really is a very simple program, but one that I am immensely proud of. It has saved me, and others, countless hours, and although I haven’t written any code for it in a few months, I am officially retiring the project as of now. The only reason I call it officially retired is because I have my sights set on a new project. I even started a new folder on my Desktop called “New Project”. What that one is, is a secret, but FinSpec holds a warm spot in my heart. FinSpec really is my first ‘major’ programming build. It consists of ~6000 lines of code, and much of it is highly unoptimized. When I first started the project, I built it all in a single py file (this was a really bad idea). Through lots of trial and tribulation though, I learned a lot and now know a few more tricks. 
        <br>
        <br>
        FinSpec is written in Python 3 with Tkinter. I like Tkinter’s easy interface building. I originally was going to write it with Pygame, but oh am I glad I didn’t do that. The program definitely has an early 2000’s software vibe. I tried to build it to be as user friendly as possible, and for the most part I achieved this. I am going to go over the major points of the build and explain what is going on. 
        <br>
        <br>
        FinSpec is basically a suite of simple tools to help with toxicology testing on a mass spectrometer. The original program was named SpecPos, but after more tools were added, I changed the name to FinSpec. You can still see the original SpecPos on the main page. 
    </p>

    <br><br><br>
    <h1 style="text-align: center;">SpecPos</h1>

    <p id="JE_main_text">
        This tool takes in an Excel report that is generated by mass specs, and it delivers a PDF with all of the sample’s positive results (results greater than the cutoff). It also categorizes the positives based on whether or not a physician ordered that specific test. 
        <br>
        <br>
        Really the only parameter that must be met is the file. Once the “Choose a file to execute” button is pressed, the file finder activates, and the user can select the correct Excel sheet. The export location automatically populates with what is in the settings, but it can also be changed if needed. Name the PDF and execute. I will explain the SpecCheck data in the next section, but it is the list of physician orders (this is also an excel file).
    </p>

    <img src="../images/FinSpecImages/SpecPos.png" alt="SpecPos" style="display: block; margin-left: auto; margin-right: auto; margin-top: 2rem; margin-bottom: 2rem; border: solid .1rem black; padding: .1rem;">
    
    <p id="JE_main_text">
        Below is a portion of the PDF output. These are test specimens, and the white would be where specimen ID’s would go. Since they were tests, I didn’t input a name. The left box is positive, ordered analytes and the right is positive, not ordered analytes.
    </p>

    <img src="../images/FinSpecImages/SpecPosPDF.png" alt="SpecPos PDF" style="display: block; margin-left: auto; margin-right: auto; margin-top: 2rem; margin-bottom: 2rem; border: solid .1rem black; padding: .1rem;">

    <p id="JE_main_text">
        These outputs are a great way to summarize data and to quickly see if there may be a mistake. For example, if EDDP was positive but methadone was negative, we would go back to the instrument and check to see what may be going on. Also, if EDDP was positive ordered and methadone was positive not ordered, we would check the order to make sure it's correct. 
    </p>


    <br><br><br>
    <h1 style="text-align: center;">SpecCheck</h1>

    <p id="JE_main_text">
        SpecCheck was one of my most ambitious parts of this project. It displays the physician's orders per specimen. Before, we were going to each drug individually and checking the specimen for every analyte we tested. So, if we had 100 specimens, we would test all 100 for all of our analytes. This program allows us to see what a specimen is ordered for. Really it is likely a specimen only is being checked for a few analytes, so instead of checking 50 analytes on 100 specimens, you check ~10 analytes on each of the specimens (1000 vs 5000 checks). On large runs, this is a life saver. 
        <br>
        <br>
        The parameters are pretty easy. I interfaced our current LIS to drop the necessary data into the program, or you could manually enter if needed. You also had to select a file that contained all of the specimens on the run. If you have different specimens on different instruments, this was accounted for by this list. Finally just execute and you come up with a page with a column. This column will populate with specimen ID’s for each individual test. You click the back and next buttons to move to the different drugs. The drugs move in order of how they come off of the mass spec for easy viewing. If the list is blank, there are no orders for that drug, so it can essentially be skipped. The morphine and THC buttons are to move quickly to the front and end of the analytes. 
    </p>

    <div style="display: flex; gap: 2rem;">
    <img src="../images/FinSpecImages/SpecCheck.png" alt="SpecCheck" style="align-self: center; margin-left: auto; margin-top: 2rem; margin-bottom: 2rem; border: solid .1rem black; padding: .1rem;">
    <img src="../images/FinSpecImages/SpecCheckList.png" alt="SpecCheck List" style="display: block; margin-right: auto; margin-top: 2rem; margin-bottom: 2rem; border: solid .1rem black; padding: .1rem;">
    </div>


    <br><br><br>
    <h1 style="text-align: center;">DataStrip</h1>
    
    <p id="JE_main_text">
        This program is very simple. If you have to input a SpecCheck list manually, you will have to use this program. It takes in an excel sheet and strips all of the unnecessary data off of it. This way there is no client information. The only information is ID and tests. SpecCheck will not work without stripped data. Text will display once each of the steps are complete. 
    </p>

    <img src="../images/FinSpecImages/DataStrip.png" alt="DataStrip" style="display: block; margin-left: auto; margin-right: auto; margin-top: 2rem; margin-bottom: 2rem; border: solid .1rem black; padding: .1rem;">


    <br><br><br>
    <h1 style="text-align: center;">SpecTime</h1>
    
    <p id="JE_main_text">
        Simply input the amount of samples, QC sets, and whether or not a calibration curve is running, and it will calculate the amount of time to complete the run. There are equilibrium times that the program accounts for based on the inputs, and the program is correct within a +- 15 minute window. The problem really is those equilibrium times. Sometimes they happen almost instantly, other times it takes 20 minutes, so a 15 minute swing was about as close as I could get it without taking too many risks on calculations. 
    </p>

    <img src="../images/FinSpecImages/SpecTime.png" alt="SpecTime" style="display: block; margin-left: auto; margin-right: auto; margin-top: 2rem; margin-bottom: 2rem; border: solid .1rem black; padding: .1rem;">


    <br><br><br>
    <h1 style="text-align: center;">SpecUp</h1>
    
    <p id="JE_main_text">
        One of, if not the most, breath easy programs. Due to the nature of mass spec, sometimes the run will just fail while no one is around. Usually the machine can just be brought back up with just a simple screen share and warming. The difficult part is knowing it is down to check on it. This program just reads the folder that the instrument creates, and it makes sure it is always being written to. If it goes too long without seeing anything, it sends an email to everyone in the lab saying that the machine is down. The emails can be configured in settings, and it just makes it so easy to then quickly jump on a computer, at home, and start the run back up. There is nothing worse than coming in, in the morning, and seeing the machine only did 2 of the 100 samples. 
        <br>
        <br>
        The program will end once it hits the last QC. Once this file is written, the program knows that there will be no more files written and to shut off. There is also a setting to have an email sent once a run ends, this way you know for a fact it completed. 
    </p>

    <img src="../images/FinSpecImages/SpecUp.png" alt="SpecUp" style="display: block; margin-left: auto; margin-right: auto; margin-top: 2rem; margin-bottom: 2rem; border: solid .1rem black; padding: .1rem;">



    <br><br><br>
    <h1 style="text-align: center;">SpecLog</h1>

    <p id="JE_main_text">
        I really wish I could have gotten more people to use SpecLog. Although I am biased towards it, I really feel it is a great way to keep up on instrument maintenance. Simply check the maintenance complete, write a comment if necessary, and submit. This would save it to a program and to an Excel sheet that could be easily printed once a month and signed. Selecting “Past Maintenance” displayed a list that could be clicked through to quickly see what had been done. This list was per machine, so if a different computer had SpecLog up, it would tie to only that machine, not the others. This way you knew what you were looking at was for that specific instrument. 
        <br>
        <br>
        The best part, as seen on the main page and on the maintenance page, was the most recent of each of the selections. This way the technician could easily see the last time something was done and complete it, if overdue. I had plans to turn it red if it was overdue, but I did not get around to this.    
    </p>

    <div style="display: flex; gap: 2rem;">
    <img src="../images/FinSpecImages/SpecLogPage1.png" alt="SpecLog" style="align-self: center; margin-left: auto; margin-top: 2rem; margin-bottom: 2rem; border: solid .1rem black; padding: .1rem;">
    <img src="../images/FinSpecImages/SpecLogPage2.png" alt="SpecLog Previous Entries" style="display: block; margin-right: auto; margin-top: 2rem; margin-bottom: 2rem; border: solid .1rem black; padding: .1rem;">
    </div>


    <br><br><br>
    <h1 style="text-align: center;">Settings</h1>
    
    <p id="JE_main_text">
        This only leaves us with the settings. Within the settings, I have detailed guides for each of the programs. Almost everything can be changed within the settings. Clicking each of the above tabs will take you where you need to go. On the far right is the Admin page. This is not what you think it is; I hid two games I made in there. I guess you’ll never get to know them unless you get a copy of the program, but I can promise you they were pretty darn fun (if not kind of silly). Plus they had highscores!
    </p>

    <img src="../images/FinSpecImages/FinSpecSettings.png" alt="Settings" style="display: block; margin-left: auto; margin-right: auto; margin-top: 2rem; margin-bottom: 2rem; border: solid .1rem black; padding: .1rem;">


    <br><br><br>
    <h1 style="text-align: center;">Final Thoughts</h1>
    
    <p id="JE_main_text">
        You know, it is kind of sad when you finally put something away like this. I have never been so excited by a project. I would stay late, come in early, and take it home just to get a few more minutes of work on it, and I am just proud of how it turned out. It is not perfect, but it runs fast and does the job well. I feel I could go much more in depth on each of the tools. There are so many uses for each of them, and I constantly found more places in which they could be used or made better. 
        <br>
        <br>
        I know this project will not be revived. I would start from scratch if I did it again, because it is quite a process to debug and maintain. The current, running version is stable, so I am not going to mess with it. What is this page? I guess more of a homage to A LOT of work. If someone else wanted tools like this, like I said, I would build it from the ground up. The second time around would be a piece of cake! The theories are all there; it is just about making the code prettier this time. 
        <br>
        <br>
        Oh and yeah you are probably wondering why everything is ‘Spec-something’. I originally thought SpecPos was super clever, so I made it a running joke to make sure ‘Spec’ was used. If you didn’t already know, I am quite the wordsmith ;).

    </p>



<br><br><br><br><br><br><br><br><br>
</body>
</html>